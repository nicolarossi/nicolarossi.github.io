---
layout: page-fullwidth
title: "RCS malware analysis"
subheadline: "Reverse engineering"
meta_teaser: "Un analisi di uno dei più sofisticati malware che siano mai stati trovati per Android : Remote Control System  di Hacking Team"
teaser: "Un analisi di uno dei più sofisticati malware che siano mai stati trovati per Android : <em>Remote Control System  di Hacking Team</em>"
header: 
    image: tor.jpg
    background-color: "#91026a"
    caption: Image by Webvilla
    caption_url: "https://unsplash.com/webvilla"
image:
    thumb:  tor_thumb.jpg
    homepage: tor.jpg
    caption: Image by Webvilla
    caption_url: "https://unsplash.com/webvilla"
categories:
    - Security
---
<div class="row">
<div class="medium-4 medium-push-8 columns" markdown="1">
<div class="panel radius" markdown="1">
**Table of Contents**
{: #toc }
*  TOC
{:toc}
</div>
</div><!-- /.medium-4.columns -->



<div class="medium-8 medium-pull-4 columns" markdown="1">

##  Malware analysis

><span class="teaser"> Tutto è possibile con le giuste risorse</span>
<cite>/proc/self/exe</cite>

Inanzitutto è da considerare RCS come un malware.
Non essendo un'applicazione voluta richiesta dal dispositivo target è da considerarlo come malware, considerazioni etico-morali sulle intercettazioni e sui trojan di stato, sono esterne da questo articolo.

Chiarito questo il secondo passo, è capire come poteva essere installato tale software sul dispositivo target.

In questo [articolo] [1] viene spiegato che l'applicativo di HT aggirava i sistemi di Google Play tramite social engineering .
Usando il nome [BeNews] [2] per acquisire credibilità dall'utente.
La parte ironica è che [BeNews] [2] era una piattaforma di news per notizie relative al sistema operativo BeOS , un sistema Linux-based .

La propagazione quindi avveniva visitando una semplice URL inviata all'obiettivo.

Una volta installata l'app questa usava la  [CVE-2014-3153] [5] per ottenere il [privilege escalation][3] necessario per eseguire codice malevolo.

Terzo passo è ad comprendere come il sistema RCS si nascondeva ai tentativi di rilevazione
e per fare ciò usava tre tecniche differenti.

> "To avoid detection and removal of the agent app in the device memory, the RCS-Android suite also detects emulators or sandboxes, obfuscates code using DexGuard, uses ELF string obfuscator, and adjusts the OOM (out-of-memory) value."
<cite> Veo Zhang (Mobile Threats Analyst)

## Contromisure e conclusioni

Qui le vulnerabilità che espongono il sistema target al malware erano 2 :
<el>
<li>- la CVE-2014-3153</li>
<li>- la cattiva abitudine di installare app di fonte sconosciuta.</li>
</el>


Con la giusta quantità di risorse, Hacking Team è riuscita a sviluppare un software potente e sofisticato.
Ma un grande aiuto gliel'ha data un utente irresponsabile ed un'pò incosciente ad installare applicazioni provenienti da fonti inattendibili.

Aggiornamenti continui del software avrebbe permesso di non essere più esposti alla minaccia CVE-2014-3153 .



[1]: http://blog.trendmicro.com/trendlabs-security-intelligence/fake-news-app-in-hacking-team-dump-designed-to-bypass-google-play/
[2]: https://en.wikipedia.org/wiki/BeNews
[3]: https://en.wikipedia.org/wiki/Privilege_escalation
[4]: http://blog.trendmicro.com/trendlabs-security-intelligence/hacking-team-rcsandroid-spying-tool-listens-to-calls-roots-devices-to-get-in/
[5]: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3153




</div><!-- /.medium-8.columns -->
</div><!-- /.row -->


